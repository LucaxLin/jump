System.register("chunks:///_virtual/calcPolygon.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var n,t;return{setters:[function(r){n=r.createForOfIteratorHelperLoose},function(r){t=r.cclegacy}],execute:function(){function e(r,n,t){return(n.x-r.x)*(t.y-r.y)-(n.y-r.y)*(t.x-r.x)}function o(r,n){return Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2)}r("getMaxPolygonVertices",(function(r){return function(r){var t=Array.from(new Set(r.map((function(r){return r.x+","+r.y})))).map((function(r){var n=r.split(",").map(Number);return{x:n[0],y:n[1]}}));if(t.length<3)return t;for(var a,u=t[0],c=n(t);!(a=c()).done;){var i=a.value;(i.y<u.y||i.y===u.y&&i.x<u.x)&&(u=i)}for(var l,f=t.sort((function(r,n){var t=e(u,r,n);return 0!==t?-t:o(u,r)-o(u,n)})),p=[],s=n(f);!(l=s()).done;){for(var y=l.value;p.length>=2&&e(p[p.length-2],p[p.length-1],y)<=0;)p.pop();p.push(y)}return p}((t=r,t.map((function(r){var n=r.split(",").map((function(r){return r.trim()})),t=n[0],e=n[1],o=parseInt(t,10),a=parseInt(e,10);if(isNaN(o)||isNaN(a))throw new Error("无效的坐标格式："+r+'，请确保格式为 "数字, 数字"');return{x:o,y:a}}))));var t})),t._RF.push({},"247aaHti+FOY6+0XhosE7Sn","calcPolygon",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/constant.ts",["cc"],(function(c){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"cb6adecY+pLlr/gMY629rcR","constant",void 0);c("BLOCK_SIZE",64),c("PHYSICS_GROUP",{DEFAULT:1,PLAYER:2,GROUND:4,TRAP:8,WALL:16});t._RF.pop()}}}));

System.register("chunks:///_virtual/FloorBlock.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var t,r,n,c;return{setters:[function(o){t=o.inheritsLoose},function(o){r=o.cclegacy,n=o._decorator,c=o.Component}],execute:function(){var e;r._RF.push({},"fe6b2sRqNpEGa5dXSMEGNla","FloorBlock",void 0);var l=n.ccclass;n.property,o("FloorBlock",l("FloorBlock")(e=function(o){function r(){return o.apply(this,arguments)||this}t(r,o);var n=r.prototype;return n.start=function(){},n.update=function(o){},r}(c))||e);r._RF.pop()}}}));

System.register("chunks:///_virtual/floorManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FloorBlock.ts","./constant.ts"],(function(o){var t,r,e,n,i,a,l,s,c,f,u,p;return{setters:[function(o){t=o.applyDecoratedDescriptor,r=o.inheritsLoose,e=o.initializerDefineProperty,n=o.assertThisInitialized},function(o){i=o.cclegacy,a=o._decorator,l=o.Prefab,s=o.instantiate,c=o.Vec3,f=o.Component},function(o){u=o.FloorBlock},function(o){p=o.BLOCK_SIZE}],execute:function(){var h,g,b,y,P,d,v,B,k;i._RF.push({},"fdd13Yr4rdOpImMYdRlOwC5","floorManager",void 0);var m=a.ccclass,w=a.property;o("floorManager",(h=m("floorManager"),g=w({type:l,tooltip:"floor预制体"}),b=w({tooltip:"地板起始位置"}),y=w({tooltip:"地板长度（方块数量）"}),h((v=t((d=function(o){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o.call.apply(o,[this].concat(i))||this,e(t,"floorBlockPrefab",v,n(t)),e(t,"startPos",B,n(t)),e(t,"floorLength",k,n(t)),t.floorBlocks=[],t}r(t,o);var i=t.prototype;return i.start=function(){this.generateFloor()},i.generateFloor=function(){for(var o=0;o<this.floorLength;o++){var t=s(this.floorBlockPrefab);t.name="floorBlock",t.parent=this.node;var r=new c(this.startPos.x+o*p,this.startPos.y,this.startPos.z);t.setPosition(r);var e=t.getComponent(u);this.floorBlocks.push(e)}},i.update=function(o){},t}(f)).prototype,"floorBlockPrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(d.prototype,"startPos",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,0,0)}}),k=t(d.prototype,"floorLength",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),P=d))||P));i._RF.pop()}}}));

System.register("chunks:///_virtual/HomePageActions.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,n,c,r;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,c=t.director,r=t.Component}],execute:function(){var i;e._RF.push({},"4aca0fxJ+hH1rsbcdrZNhBI","HomePageActions",void 0);var a=n.ccclass;n.property,t("HomePageActions",a("HomePageActions")(i=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.start=function(){},n.exitGame=function(){window.close()},n.goTutorial=function(){c.loadScene("tutorial")},n.update=function(t){},e}(r))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./FloorBlock.ts","./HomePageActions.ts","./MoveTrap.ts","./PlayerController.ts","./SpikeController.ts","./TiledMapCollision.ts","./Trap.ts","./calcPolygon.ts","./constant.ts","./floorManager.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MoveTrap.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Trap.ts"],(function(t){var e,i,r,o,n,p,s,a,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){n=t.cclegacy,p=t._decorator,s=t.Node,a=t.Vec3},function(t){c=t.Trap}],execute:function(){var l,u,h,y,d;n._RF.push({},"f35bcyGOV5DoYKpG9bKmAis","MoveTrap",void 0);var f=p.ccclass,g=p.property;t("MoveTrap",(l=f("MoveTrap"),u=g({type:s,tooltip:"player 节点"}),l((d=e((y=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),p=0;p<i;p++)n[p]=arguments[p];return e=t.call.apply(t,[this].concat(n))||this,r(e,"player",d,o(e)),e.triggered=!1,e}i(e,t);var n=e.prototype;return n.start=function(){},n.update=function(t){this.player.position.x>=this.node.position.x&&!this.triggered&&(this.force.x=-200,this.node.position=new a(this.node.position.x+100,this.node.position.y,this.node.position.z),this.triggered=!0)},e}(c)).prototype,"player",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=y))||h));n._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./Trap.ts"],(function(i){var e,t,o,r,n,s,a,l,h,u,c,d,p,y,m,g,v;return{setters:[function(i){e=i.applyDecoratedDescriptor,t=i.inheritsLoose,o=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){n=i.cclegacy,s=i._decorator,a=i.Vec2,l=i.Animation,h=i.RigidBody2D,u=i.input,c=i.Input,d=i.Collider2D,p=i.Contact2DType,y=i.Vec3,m=i.Component},function(i){g=i.PHYSICS_GROUP},function(i){v=i.Trap}],execute:function(){var f,M,D,T,C,b,w,B,E,_,P,V,S;n._RF.push({},"75b69aaYCZH1biBSVy1sgR1","PlayerController",void 0);var A=s.ccclass,H=s.property;i("PlayerControll",(f=A("PlayerControll"),M=H({tooltip:"移动速度"}),D=H({tooltip:"是否面向右（初始朝向）"}),T=H({tooltip:"跳跃速度"}),C=H({tooltip:"跳跃冷却时间（秒）"}),b=H({tooltip:"自动行走"}),f((E=e((B=function(i){function e(){for(var e,t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e=i.call.apply(i,[this].concat(n))||this,o(e,"moveSpeed",E,r(e)),o(e,"isFaceRight",_,r(e)),o(e,"jumpSpeed",P,r(e)),o(e,"jumpCD",V,r(e)),o(e,"autoMove",S,r(e)),e.isGrounded=!0,e.isJumpEndTriggered=!1,e.tempVec2=new a(0,0),e.lastJumpTime=0,e.groundVelocityThreshold=.1,e.rigidBody=null,e.animation=null,e.collider=null,e.curMoveThreshold=.001,e.curMoveDir=0,e.allowMove=!0,e.isHurt=!1,e}t(e,i);var n=e.prototype;return n.onLoad=function(){this.animation=this.getComponent(l),this.rigidBody=this.getComponent(h),u.on(c.EventType.KEY_DOWN,this.onKeyDown,this),u.on(c.EventType.KEY_UP,this.onKeyUp,this),this.collider=this.getComponent(d),this.collider&&this.collider.on(p.BEGIN_CONTACT,this.onCollisionEnter2D,this),this.autoMove&&(this.curMoveDir=1,this.collider.on(p.BEGIN_CONTACT,this.autoMoveHandler,this))},n.autoMoveHandler=function(i,e){e.group===g.WALL&&(this.curMoveDir*=-1)},n.onKeyDown=function(i){if(!this.autoMove)switch(i.keyCode){case 37:this.curMoveDir=-1;break;case 39:this.curMoveDir=1;break;case 32:this.jump()}},n.onKeyUp=function(i){if(!this.autoMove)switch(this.allowMove=!0,i.keyCode){case 37:-1===this.curMoveDir&&(this.curMoveDir=-this.curMoveThreshold);break;case 39:1===this.curMoveDir&&(this.curMoveDir=this.curMoveThreshold)}},n.jump=function(){var i=Date.now()/1e3;i-this.lastJumpTime<this.jumpCD||Math.abs(this.rigidBody.linearVelocity.y)<this.groundVelocityThreshold&&this.isGrounded&&(this.rigidBody.applyLinearImpulse(new a(0,this.jumpSpeed),this.rigidBody.getWorldCenter(this.tempVec2),!0),this.isGrounded=!1,this.lastJumpTime=i)},n.onCollisionEnter2D=function(i,e){var t=this;"door"===e.node.name&&(this.allowMove=!1),e.group!==g.GROUND||this.isJumpEndTriggered?e.group===g.TRAP&&this.handleHitTrap(e.node.getComponent(v)):(this.isGrounded=!0,this.isHurt=!1,this.isJumpEndTriggered=!0,setTimeout((function(){t.isJumpEndTriggered=!1}),100))},n.handleHitTrap=function(i){var e=this;this.isHurt=!0,this.rigidBody.linearVelocity=new a(0,0),this.rigidBody.angularVelocity=0,i.getComponent(d).enabled=!1,setTimeout((function(){i.getComponent(d).enabled=!0}),100),this.rigidBody.applyLinearImpulse(new a(0,i.force.y),this.rigidBody.getWorldCenter(this.tempVec2),!0),setTimeout((function(){e.rigidBody.applyLinearImpulse(new a(i.force.x,0),e.rigidBody.getWorldCenter(e.tempVec2),!0)}),16)},n.playAnimation=function(i){var e;null!=(e=this.animation.getState(i))&&e.isPlaying||this.animation.crossFade(i,.1)},n.flipPlayer=function(i){this.isFaceRight!==i&&(this.isFaceRight=i,this.node.setScale(new y(i?1:-1,1,1)))},n.update=function(i){var e=this.rigidBody.linearVelocity;e.x=this.curMoveDir*this.moveSpeed,e.y=this.rigidBody.linearVelocity.y,this.rigidBody.linearVelocity=e,this.isHurt?this.playAnimation("player_hurt"):Math.abs(this.curMoveDir)>this.curMoveThreshold&&this.isGrounded?this.playAnimation("player_walk"):this.isGrounded?this.playAnimation("player_stand"):this.playAnimation("player_jump"),this.flipPlayer(Math.abs(this.curMoveDir)>this.curMoveThreshold?this.curMoveDir>0:this.isFaceRight),this.isHurt||Math.abs(this.curMoveDir)>this.curMoveThreshold&&this.allowMove&&this.node.setPosition(this.node.position.add3f(this.curMoveDir*this.moveSpeed*i,0,0))},n.onDestroy=function(){u.off(c.EventType.KEY_DOWN,this.onKeyDown,this),u.off(c.EventType.KEY_UP,this.onKeyUp,this),this.collider&&this.collider.off(p.BEGIN_CONTACT,this.onCollisionEnter2D,this)},e}(m)).prototype,"moveSpeed",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),_=e(B.prototype,"isFaceRight",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),P=e(B.prototype,"jumpSpeed",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 180}}),V=e(B.prototype,"jumpCD",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),S=e(B.prototype,"autoMove",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=B))||w));n._RF.pop()}}}));

System.register("chunks:///_virtual/SpikeController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,t,n,o,i,l,a,c;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,l=e._decorator,a=e.Node,c=e.Component}],execute:function(){var p,u,s,f,y;i._RF.push({},"4babbxbOkhMU4wKv7CADaRk","SpikeController",void 0);var b=l.ccclass,h=l.property;e("SpikeController",(p=b("SpikeController"),u=h(a),p((y=r((f=function(e){function r(){for(var r,t=arguments.length,i=new Array(t),l=0;l<t;l++)i[l]=arguments[l];return r=e.call.apply(e,[this].concat(i))||this,n(r,"player",y,o(r)),r}t(r,e);var i=r.prototype;return i.start=function(){},i.update=function(e){},r}(c)).prototype,"player",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),s=f))||s));i._RF.pop()}}}));

System.register("chunks:///_virtual/TiledMapCollision.ts",["./rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./calcPolygon.ts"],(function(i){var e,o,t,n,l,r,a,s,c,u,d,p,h;return{setters:[function(i){e=i.applyDecoratedDescriptor,o=i.inheritsLoose,t=i.initializerDefineProperty,n=i.assertThisInitialized},function(i){l=i.cclegacy,r=i._decorator,a=i.Node,s=i.TiledMap,c=i.Vec2,u=i.PolygonCollider2D,d=i.Component},function(i){p=i.PHYSICS_GROUP},function(i){h=i.getMaxPolygonVertices}],execute:function(){var f,g,y,m,z,C,v,P;l._RF.push({},"68f7egP6mpGsIRlVBKfxCR3","TiledMapCollision",void 0);var S=r.ccclass,b=r.property;i("tiledCollider",(f=S("tiledCollider"),g=b(a),f((z=e((m=function(i){function e(){for(var e,o=arguments.length,l=new Array(o),r=0;r<o;r++)l[r]=arguments[r];return e=i.call.apply(i,[this].concat(l))||this,t(e,"collisionLayerName",z,n(e)),t(e,"tileSize",C,n(e)),t(e,"colliderName",v,n(e)),t(e,"collisionRoot",P,n(e)),e.colliderPoints=new Set,e}o(e,i);var l=e.prototype;return l.onLoad=function(){this.generateCollision()},l.generateCollision=function(){if(this.collisionRoot)return!1;var i=this.node.getComponent(s);this.collisionRoot=new a(this.colliderName);var e=i.getLayer(this.collisionLayerName);if(e){for(var o=e.getLayerSize(),t=0;t<o.height;t++)for(var n=0;n<o.width;n++){if(!(e.getTileGIDAt(n,t)<=0)){var l=n*this.tileSize.x,r=(o.height-1-t)*this.tileSize.y;this.colliderPoints.add(l+", "+r),this.colliderPoints.add(l+this.tileSize.x+", "+r),this.colliderPoints.add(l+this.tileSize.x+", "+(r+this.tileSize.y)),this.colliderPoints.add(l+", "+(r+this.tileSize.y))}}this.generateCollider()}else console.error("未找到碰撞层：",this.collisionLayerName)},l.generateCollider=function(){var i=Array.from(this.colliderPoints).map((function(i){return i.toString()})),e=h(i).map((function(i){var e=i.x,o=i.y;return new c(e,o)})),o=this.collisionRoot.addComponent(u);o.points=e,o.group=p.GROUND,o.apply(),this.collisionRoot.parent=this.node.parent,console.log("生成碰撞体完成")},l.update=function(i){},e}(d)).prototype,"collisionLayerName",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ground"}}),C=e(m.prototype,"tileSize",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(70,70)}}),v=e(m.prototype,"colliderName",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"TiledCollider"}}),P=e(m.prototype,"collisionRoot",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=m))||y));l._RF.pop()}}}));

System.register("chunks:///_virtual/Trap.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,t,n,o,i,a,c,p;return{setters:[function(r){e=r.applyDecoratedDescriptor,t=r.inheritsLoose,n=r.initializerDefineProperty,o=r.assertThisInitialized},function(r){i=r.cclegacy,a=r._decorator,c=r.Component,p=r.Vec2}],execute:function(){var u,s,l,f,y;i._RF.push({},"e14a4NMTLJE3L3zJkBnLUfs","Trap",void 0);var h=a.ccclass,v=a.property;r("Trap",(u=h("Trap"),s=v({tooltip:"陷阱反弹力度"}),u((y=e((f=function(r){function e(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return e=r.call.apply(r,[this].concat(i))||this,n(e,"force",y,o(e)),e}t(e,r);var i=e.prototype;return i.start=function(){},i.update=function(r){},e}(c)).prototype,"force",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new p(-100,150)}}),l=f))||l));i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});